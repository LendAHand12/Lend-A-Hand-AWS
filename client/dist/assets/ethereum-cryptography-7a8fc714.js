import{c as Nt,g as ke}from"./@ethereumjs-a0310e2a.js";import{r as Be}from"./@noble-904ea724.js";function ve(e,t){for(var s=0;s<t.length;s++){const n=t[s];if(typeof n!="string"&&!Array.isArray(n)){for(const o in n)if(o!=="default"&&!(o in e)){const i=Object.getOwnPropertyDescriptor(n,o);i&&Object.defineProperty(e,o,i.get?i:{enumerable:!0,get:()=>n[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var K={},I={},C={};Object.defineProperty(C,"__esModule",{value:!0});C.output=C.exists=C.hash=C.bytes=C.bool=C.number=void 0;function jt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}C.number=jt;function Qt(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}C.bool=Qt;function Ft(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}C.bytes=Ft;function Yt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");jt(e.outputLen),jt(e.blockLen)}C.hash=Yt;function Zt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}C.exists=Zt;function te(e,t){Ft(e);const s=t.outputLen;if(e.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}C.output=te;const Ae={number:jt,bool:Qt,bytes:Ft,hash:Yt,exists:Zt,output:te};C.default=Ae;var Ct={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.add=e.toBig=e.split=e.fromBig=void 0;const t=BigInt(2**32-1),s=BigInt(32);function n(w,g=!1){return g?{h:Number(w&t),l:Number(w>>s&t)}:{h:Number(w>>s&t)|0,l:Number(w&t)|0}}e.fromBig=n;function o(w,g=!1){let _=new Uint32Array(w.length),j=new Uint32Array(w.length);for(let U=0;U<w.length;U++){const{h:D,l:V}=n(w[U],g);[_[U],j[U]]=[D,V]}return[_,j]}e.split=o;const i=(w,g)=>BigInt(w>>>0)<<s|BigInt(g>>>0);e.toBig=i;const r=(w,g,_)=>w>>>_,c=(w,g,_)=>w<<32-_|g>>>_,h=(w,g,_)=>w>>>_|g<<32-_,u=(w,g,_)=>w<<32-_|g>>>_,f=(w,g,_)=>w<<64-_|g>>>_-32,a=(w,g,_)=>w>>>_-32|g<<64-_,l=(w,g)=>g,b=(w,g)=>w,p=(w,g,_)=>w<<_|g>>>32-_,x=(w,g,_)=>g<<_|w>>>32-_,B=(w,g,_)=>g<<_-32|w>>>64-_,L=(w,g,_)=>w<<_-32|g>>>64-_;function T(w,g,_,j){const U=(g>>>0)+(j>>>0);return{h:w+_+(U/2**32|0)|0,l:U|0}}e.add=T;const v=(w,g,_)=>(w>>>0)+(g>>>0)+(_>>>0),d=(w,g,_,j)=>g+_+j+(w/2**32|0)|0,k=(w,g,_,j)=>(w>>>0)+(g>>>0)+(_>>>0)+(j>>>0),H=(w,g,_,j,U)=>g+_+j+U+(w/2**32|0)|0,m=(w,g,_,j,U)=>(w>>>0)+(g>>>0)+(_>>>0)+(j>>>0)+(U>>>0),S=(w,g,_,j,U,D)=>g+_+j+U+D+(w/2**32|0)|0,O={fromBig:n,split:o,toBig:e.toBig,shrSH:r,shrSL:c,rotrSH:h,rotrSL:u,rotrBH:f,rotrBL:a,rotr32H:l,rotr32L:b,rotlSH:p,rotlSL:x,rotlBH:B,rotlBL:L,add:T,add3L:v,add3H:d,add4L:k,add4H:H,add5H:S,add5L:m};e.default=O})(Ct);var M={},vt={};Object.defineProperty(vt,"__esModule",{value:!0});vt.crypto=void 0;vt.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;(function(e){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const t=vt,s=d=>new Uint8Array(d.buffer,d.byteOffset,d.byteLength);e.u8=s;const n=d=>new Uint32Array(d.buffer,d.byteOffset,Math.floor(d.byteLength/4));e.u32=n;const o=d=>new DataView(d.buffer,d.byteOffset,d.byteLength);e.createView=o;const i=(d,k)=>d<<32-k|d>>>k;if(e.rotr=i,e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!e.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},(d,k)=>k.toString(16).padStart(2,"0"));function c(d){if(!(d instanceof Uint8Array))throw new Error("Uint8Array expected");let k="";for(let H=0;H<d.length;H++)k+=r[d[H]];return k}e.bytesToHex=c;function h(d){if(typeof d!="string")throw new TypeError("hexToBytes: expected string, got "+typeof d);if(d.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const k=new Uint8Array(d.length/2);for(let H=0;H<k.length;H++){const m=H*2,S=d.slice(m,m+2),O=Number.parseInt(S,16);if(Number.isNaN(O)||O<0)throw new Error("Invalid byte sequence");k[H]=O}return k}e.hexToBytes=h;const u=async()=>{};e.nextTick=u;async function f(d,k,H){let m=Date.now();for(let S=0;S<d;S++){H(S);const O=Date.now()-m;O>=0&&O<k||(await(0,e.nextTick)(),m+=O)}}e.asyncLoop=f;function a(d){if(typeof d!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof d}`);return new TextEncoder().encode(d)}e.utf8ToBytes=a;function l(d){if(typeof d=="string"&&(d=a(d)),!(d instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof d})`);return d}e.toBytes=l;function b(...d){if(!d.every(m=>m instanceof Uint8Array))throw new Error("Uint8Array list expected");if(d.length===1)return d[0];const k=d.reduce((m,S)=>m+S.length,0),H=new Uint8Array(k);for(let m=0,S=0;m<d.length;m++){const O=d[m];H.set(O,S),S+=O.length}return H}e.concatBytes=b;class p{clone(){return this._cloneInto()}}e.Hash=p;const x=d=>Object.prototype.toString.call(d)==="[object Object]"&&d.constructor===Object;function B(d,k){if(k!==void 0&&(typeof k!="object"||!x(k)))throw new TypeError("Options should be object or undefined");return Object.assign(d,k)}e.checkOpts=B;function L(d){const k=m=>d().update(l(m)).digest(),H=d();return k.outputLen=H.outputLen,k.blockLen=H.blockLen,k.create=()=>d(),k}e.wrapConstructor=L;function T(d){const k=(m,S)=>d(S).update(l(m)).digest(),H=d({});return k.outputLen=H.outputLen,k.blockLen=H.blockLen,k.create=m=>d(m),k}e.wrapConstructorWithOpts=T;function v(d=32){if(t.crypto&&typeof t.crypto.getRandomValues=="function")return t.crypto.getRandomValues(new Uint8Array(d));throw new Error("crypto.getRandomValues must be defined")}e.randomBytes=v})(M);Object.defineProperty(I,"__esModule",{value:!0});I.shake256=I.shake128=I.keccak_512=I.keccak_384=I.keccak_256=I.keccak_224=I.sha3_512=I.sha3_384=I.sha3_256=I.sha3_224=I.Keccak=I.keccakP=void 0;const ot=C,pt=Ct,xt=M,[ee,se,ne]=[[],[],[]],He=BigInt(0),bt=BigInt(1),Le=BigInt(2),me=BigInt(7),Se=BigInt(256),Ee=BigInt(113);for(let e=0,t=bt,s=1,n=0;e<24;e++){[s,n]=[n,(2*s+3*n)%5],ee.push(2*(5*n+s)),se.push((e+1)*(e+2)/2%64);let o=He;for(let i=0;i<7;i++)t=(t<<bt^(t>>me)*Ee)%Se,t&Le&&(o^=bt<<(bt<<BigInt(i))-bt);ne.push(o)}const[Oe,je]=pt.default.split(ne,!0),Wt=(e,t,s)=>s>32?pt.default.rotlBH(e,t,s):pt.default.rotlSH(e,t,s),qt=(e,t,s)=>s>32?pt.default.rotlBL(e,t,s):pt.default.rotlSL(e,t,s);function re(e,t=24){const s=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let r=0;r<10;r++)s[r]=e[r]^e[r+10]^e[r+20]^e[r+30]^e[r+40];for(let r=0;r<10;r+=2){const c=(r+8)%10,h=(r+2)%10,u=s[h],f=s[h+1],a=Wt(u,f,1)^s[c],l=qt(u,f,1)^s[c+1];for(let b=0;b<50;b+=10)e[r+b]^=a,e[r+b+1]^=l}let o=e[2],i=e[3];for(let r=0;r<24;r++){const c=se[r],h=Wt(o,i,c),u=qt(o,i,c),f=ee[r];o=e[f],i=e[f+1],e[f]=h,e[f+1]=u}for(let r=0;r<50;r+=10){for(let c=0;c<10;c++)s[c]=e[r+c];for(let c=0;c<10;c++)e[r+c]^=~s[(c+2)%10]&s[(c+4)%10]}e[0]^=Oe[n],e[1]^=je[n]}s.fill(0)}I.keccakP=re;class At extends xt.Hash{constructor(t,s,n,o=!1,i=24){if(super(),this.blockLen=t,this.suffix=s,this.outputLen=n,this.enableXOF=o,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ot.default.number(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,xt.u32)(this.state)}keccak(){re(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){ot.default.exists(this);const{blockLen:s,state:n}=this;t=(0,xt.toBytes)(t);const o=t.length;for(let i=0;i<o;){const r=Math.min(s-this.pos,o-i);for(let c=0;c<r;c++)n[this.pos++]^=t[i++];this.pos===s&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:s,pos:n,blockLen:o}=this;t[n]^=s,s&128&&n===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){ot.default.exists(this,!1),ot.default.bytes(t),this.finish();const s=this.state,{blockLen:n}=this;for(let o=0,i=t.length;o<i;){this.posOut>=n&&this.keccak();const r=Math.min(n-this.posOut,i-o);t.set(s.subarray(this.posOut,this.posOut+r),o),this.posOut+=r,o+=r}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return ot.default.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(ot.default.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:s,suffix:n,outputLen:o,rounds:i,enableXOF:r}=this;return t||(t=new At(s,n,o,r,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=n,t.outputLen=o,t.enableXOF=r,t.destroyed=this.destroyed,t}}I.Keccak=At;const Q=(e,t,s)=>(0,xt.wrapConstructor)(()=>new At(t,e,s));I.sha3_224=Q(6,144,224/8);I.sha3_256=Q(6,136,256/8);I.sha3_384=Q(6,104,384/8);I.sha3_512=Q(6,72,512/8);I.keccak_224=Q(1,144,224/8);I.keccak_256=Q(1,136,256/8);I.keccak_384=Q(1,104,384/8);I.keccak_512=Q(1,72,512/8);const oe=(e,t,s)=>(0,xt.wrapConstructorWithOpts)((n={})=>new At(t,e,n.dkLen===void 0?s:n.dkLen,!0));I.shake128=oe(31,168,128/8);I.shake256=oe(31,136,256/8);function zt(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var It={exports:{}};It.exports;(function(e,t){var s=Nt&&Nt.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(t,"__esModule",{value:!0}),t.crypto=t.wrapHash=t.equalsBytes=t.hexToBytes=t.bytesToUtf8=t.utf8ToBytes=t.createView=t.concatBytes=t.toHex=t.bytesToHex=t.assertBytes=t.assertBool=void 0;const n=s(C),o=M,i=n.default.bool;t.assertBool=i;const r=n.default.bytes;t.assertBytes=r;var c=M;Object.defineProperty(t,"bytesToHex",{enumerable:!0,get:function(){return c.bytesToHex}}),Object.defineProperty(t,"toHex",{enumerable:!0,get:function(){return c.bytesToHex}}),Object.defineProperty(t,"concatBytes",{enumerable:!0,get:function(){return c.concatBytes}}),Object.defineProperty(t,"createView",{enumerable:!0,get:function(){return c.createView}}),Object.defineProperty(t,"utf8ToBytes",{enumerable:!0,get:function(){return c.utf8ToBytes}});function h(l){if(!(l instanceof Uint8Array))throw new TypeError(`bytesToUtf8 expected Uint8Array, got ${typeof l}`);return new TextDecoder().decode(l)}t.bytesToUtf8=h;function u(l){const b=l.startsWith("0x")?l.substring(2):l;return(0,o.hexToBytes)(b)}t.hexToBytes=u;function f(l,b){if(l.length!==b.length)return!1;for(let p=0;p<l.length;p++)if(l[p]!==b[p])return!1;return!0}t.equalsBytes=f;function a(l){return b=>(n.default.bytes(b),l(b))}t.wrapHash=a,t.crypto=(()=>{const l=typeof self=="object"&&"crypto"in self?self.crypto:void 0,b=typeof zt=="function"&&zt.bind(e);return{node:b&&!l?b("crypto"):void 0,web:l}})()})(It,It.exports);var Ht=It.exports;Object.defineProperty(K,"__esModule",{value:!0});K.keccak512=K.keccak384=Ie=K.keccak256=K.keccak224=void 0;const wt=I,Pt=Ht;K.keccak224=(0,Pt.wrapHash)(wt.keccak_224);var Ie=K.keccak256=(()=>{const e=(0,Pt.wrapHash)(wt.keccak_256);return e.create=wt.keccak_256.create,e})();K.keccak384=(0,Pt.wrapHash)(wt.keccak_384);K.keccak512=(0,Pt.wrapHash)(wt.keccak_512);var Gt={},$t={},ut={};Object.defineProperty(ut,"__esModule",{value:!0});ut.BLAKE2=ut.SIGMA=void 0;const ct=C,St=M;ut.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]);class Ue extends St.Hash{constructor(t,s,n={},o,i,r){if(super(),this.blockLen=t,this.outputLen=s,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,ct.default.number(t),ct.default.number(s),ct.default.number(o),s<0||s>o)throw new Error("outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>o))throw new Error(`key must be up 1..${o} byte long or undefined`);if(n.salt!==void 0&&n.salt.length!==i)throw new Error(`salt must be ${i} byte long or undefined`);if(n.personalization!==void 0&&n.personalization.length!==r)throw new Error(`personalization must be ${r} byte long or undefined`);this.buffer32=(0,St.u32)(this.buffer=new Uint8Array(t))}update(t){ct.default.exists(this);const{blockLen:s,buffer:n,buffer32:o}=this;t=(0,St.toBytes)(t);const i=t.length;for(let r=0;r<i;){this.pos===s&&(this.compress(o,0,!1),this.pos=0);const c=Math.min(s-this.pos,i-r),h=t.byteOffset+r;if(c===s&&!(h%4)&&r+c<i){const u=new Uint32Array(t.buffer,h,Math.floor((i-r)/4));for(let f=0;r+s<i;f+=o.length,r+=s)this.length+=s,this.compress(u,f,!1);continue}n.set(t.subarray(r,r+c),this.pos),this.pos+=c,this.length+=c,r+=c}return this}digestInto(t){ct.default.exists(this),ct.default.output(t,this);const{pos:s,buffer32:n}=this;this.finished=!0,this.buffer.subarray(s).fill(0),this.compress(n,0,!0);const o=(0,St.u32)(t);this.get().forEach((i,r)=>o[r]=i)}digest(){const{buffer:t,outputLen:s}=this;this.digestInto(t);const n=t.slice(0,s);return this.destroy(),n}_cloneInto(t){const{buffer:s,length:n,finished:o,destroyed:i,outputLen:r,pos:c}=this;return t||(t=new this.constructor({dkLen:r})),t.set(...this.get()),t.length=n,t.finished=o,t.destroyed=i,t.outputLen=r,t.buffer.set(s),t.pos=c,t}}ut.BLAKE2=Ue;Object.defineProperty($t,"__esModule",{value:!0});$t.blake2b=void 0;const Xt=ut,$=Ct,at=M,P=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),y=new Uint32Array(32);function N(e,t,s,n,o,i){const r=o[i],c=o[i+1];let h=y[2*e],u=y[2*e+1],f=y[2*t],a=y[2*t+1],l=y[2*s],b=y[2*s+1],p=y[2*n],x=y[2*n+1],B=$.default.add3L(h,f,r);u=$.default.add3H(B,u,a,c),h=B|0,{Dh:x,Dl:p}={Dh:x^u,Dl:p^h},{Dh:x,Dl:p}={Dh:$.default.rotr32H(x,p),Dl:$.default.rotr32L(x,p)},{h:b,l}=$.default.add(b,l,x,p),{Bh:a,Bl:f}={Bh:a^b,Bl:f^l},{Bh:a,Bl:f}={Bh:$.default.rotrSH(a,f,24),Bl:$.default.rotrSL(a,f,24)},y[2*e]=h,y[2*e+1]=u,y[2*t]=f,y[2*t+1]=a,y[2*s]=l,y[2*s+1]=b,y[2*n]=p,y[2*n+1]=x}function W(e,t,s,n,o,i){const r=o[i],c=o[i+1];let h=y[2*e],u=y[2*e+1],f=y[2*t],a=y[2*t+1],l=y[2*s],b=y[2*s+1],p=y[2*n],x=y[2*n+1],B=$.default.add3L(h,f,r);u=$.default.add3H(B,u,a,c),h=B|0,{Dh:x,Dl:p}={Dh:x^u,Dl:p^h},{Dh:x,Dl:p}={Dh:$.default.rotrSH(x,p,16),Dl:$.default.rotrSL(x,p,16)},{h:b,l}=$.default.add(b,l,x,p),{Bh:a,Bl:f}={Bh:a^b,Bl:f^l},{Bh:a,Bl:f}={Bh:$.default.rotrBH(a,f,63),Bl:$.default.rotrBL(a,f,63)},y[2*e]=h,y[2*e+1]=u,y[2*t]=f,y[2*t+1]=a,y[2*s]=l,y[2*s+1]=b,y[2*n]=p,y[2*n+1]=x}class Te extends Xt.BLAKE2{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=P[0]|0,this.v0h=P[1]|0,this.v1l=P[2]|0,this.v1h=P[3]|0,this.v2l=P[4]|0,this.v2h=P[5]|0,this.v3l=P[6]|0,this.v3h=P[7]|0,this.v4l=P[8]|0,this.v4h=P[9]|0,this.v5l=P[10]|0,this.v5h=P[11]|0,this.v6l=P[12]|0,this.v6h=P[13]|0,this.v7l=P[14]|0,this.v7h=P[15]|0;const s=t.key?t.key.length:0;if(this.v0l^=this.outputLen|s<<8|65536|1<<24,t.salt){const n=(0,at.u32)((0,at.toBytes)(t.salt));this.v4l^=n[0],this.v4h^=n[1],this.v5l^=n[2],this.v5h^=n[3]}if(t.personalization){const n=(0,at.u32)((0,at.toBytes)(t.personalization));this.v6l^=n[0],this.v6h^=n[1],this.v7l^=n[2],this.v7h^=n[3]}if(t.key){const n=new Uint8Array(this.blockLen);n.set((0,at.toBytes)(t.key)),this.update(n)}}get(){let{v0l:t,v0h:s,v1l:n,v1h:o,v2l:i,v2h:r,v3l:c,v3h:h,v4l:u,v4h:f,v5l:a,v5h:l,v6l:b,v6h:p,v7l:x,v7h:B}=this;return[t,s,n,o,i,r,c,h,u,f,a,l,b,p,x,B]}set(t,s,n,o,i,r,c,h,u,f,a,l,b,p,x,B){this.v0l=t|0,this.v0h=s|0,this.v1l=n|0,this.v1h=o|0,this.v2l=i|0,this.v2h=r|0,this.v3l=c|0,this.v3h=h|0,this.v4l=u|0,this.v4h=f|0,this.v5l=a|0,this.v5h=l|0,this.v6l=b|0,this.v6h=p|0,this.v7l=x|0,this.v7h=B|0}compress(t,s,n){this.get().forEach((h,u)=>y[u]=h),y.set(P,16);let{h:o,l:i}=$.default.fromBig(BigInt(this.length));y[24]=P[8]^i,y[25]=P[9]^o,n&&(y[28]=~y[28],y[29]=~y[29]);let r=0;const c=Xt.SIGMA;for(let h=0;h<12;h++)N(0,4,8,12,t,s+2*c[r++]),W(0,4,8,12,t,s+2*c[r++]),N(1,5,9,13,t,s+2*c[r++]),W(1,5,9,13,t,s+2*c[r++]),N(2,6,10,14,t,s+2*c[r++]),W(2,6,10,14,t,s+2*c[r++]),N(3,7,11,15,t,s+2*c[r++]),W(3,7,11,15,t,s+2*c[r++]),N(0,5,10,15,t,s+2*c[r++]),W(0,5,10,15,t,s+2*c[r++]),N(1,6,11,12,t,s+2*c[r++]),W(1,6,11,12,t,s+2*c[r++]),N(2,7,8,13,t,s+2*c[r++]),W(2,7,8,13,t,s+2*c[r++]),N(3,4,9,14,t,s+2*c[r++]),W(3,4,9,14,t,s+2*c[r++]);this.v0l^=y[0]^y[16],this.v0h^=y[1]^y[17],this.v1l^=y[2]^y[18],this.v1h^=y[3]^y[19],this.v2l^=y[4]^y[20],this.v2h^=y[5]^y[21],this.v3l^=y[6]^y[22],this.v3h^=y[7]^y[23],this.v4l^=y[8]^y[24],this.v4h^=y[9]^y[25],this.v5l^=y[10]^y[26],this.v5h^=y[11]^y[27],this.v6l^=y[12]^y[28],this.v6h^=y[13]^y[29],this.v7l^=y[14]^y[30],this.v7h^=y[15]^y[31],y.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}$t.blake2b=(0,at.wrapConstructorWithOpts)(e=>new Te(e));Object.defineProperty(Gt,"__esModule",{value:!0});var Ce=Gt.blake2b=void 0;const Pe=$t,$e=Ht,De=(e,t=64)=>{if((0,$e.assertBytes)(e),t<=0||t>64)throw Error("Invalid outputLength");return(0,Pe.blake2b)(e,{dkLen:t})};Ce=Gt.blake2b=De;var _t={};Object.defineProperty(_t,"__esModule",{value:!0});_t.getRandomBytes=Fe=_t.getRandomBytesSync=void 0;const ce=M;function Me(e){return(0,ce.randomBytes)(e)}var Fe=_t.getRandomBytesSync=Me;async function Ge(e){return(0,ce.randomBytes)(e)}_t.getRandomBytes=Ge;var gt={};Object.defineProperty(gt,"__esModule",{value:!0});var Re=gt.decrypt=Ke=gt.encrypt=void 0;const Ve=vt,Ot=Ht,R={web:Ve.crypto};function ie(e,t,s){if(!s.startsWith("aes-"))throw new Error(`AES submodule doesn't support mode ${s}`);if(t.length!==16)throw new Error("AES: wrong IV length");if(s.startsWith("aes-128")&&e.length!==16||s.startsWith("aes-256")&&e.length!==32)throw new Error("AES: wrong key length")}async function ae(e,t,s){if(!R.web)throw new Error("Browser crypto not available.");let n;if(["aes-128-cbc","aes-256-cbc"].includes(e)&&(n="cbc"),["aes-128-ctr","aes-256-ctr"].includes(e)&&(n="ctr"),!n)throw new Error("AES: unsupported mode");return[await R.web.subtle.importKey("raw",t,{name:`AES-${n.toUpperCase()}`,length:t.length*8},!0,["encrypt","decrypt"]),{name:`aes-${n}`,iv:s,counter:s,length:128}]}async function Rt(e,t,s,n="aes-128-ctr",o=!0){if(ie(t,s,n),R.web){const[i,r]=await ae(n,t,s),c=await R.web.subtle.encrypt(r,i,e);let h=new Uint8Array(c);return!o&&r.name==="aes-cbc"&&!(e.length%16)&&(h=h.slice(0,-16)),h}else if(R.node){const i=R.node.createCipheriv(n,t,s);return i.setAutoPadding(o),(0,Ot.concatBytes)(i.update(e),i.final())}else throw new Error("The environment doesn't have AES module")}var Ke=gt.encrypt=Rt;async function Ne(e,t,s,n){const o=e.slice(-16);for(let r=0;r<16;r++)o[r]^=s[r]^16;return(await Rt(o,t,s,n)).slice(0,16)}async function We(e,t,s,n="aes-128-ctr",o=!0){if(ie(t,s,n),R.web){const[i,r]=await ae(n,t,s);if(!o&&r.name==="aes-cbc"){const u=await Ne(e,t,s,n);e=(0,Ot.concatBytes)(e,u)}const c=await R.web.subtle.decrypt(r,i,e),h=new Uint8Array(c);if(r.name==="aes-cbc"){const u=await Rt(h,t,s,n);if(!(0,Ot.equalsBytes)(u,e))throw new Error("AES: wrong padding")}return h}else if(R.node){const i=R.node.createDecipheriv(n,t,s);return i.setAutoPadding(o),(0,Ot.concatBytes)(i.update(e),i.final())}else throw new Error("The environment doesn't have AES module")}Re=gt.decrypt=We;var kt={},nt={},he={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=void 0;const t=C,s=M;class n extends s.Hash{constructor(r,c){super(),this.finished=!1,this.destroyed=!1,t.default.hash(r);const h=(0,s.toBytes)(c);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const u=this.blockLen,f=new Uint8Array(u);f.set(h.length>u?r.create().update(h).digest():h);for(let a=0;a<f.length;a++)f[a]^=54;this.iHash.update(f),this.oHash=r.create();for(let a=0;a<f.length;a++)f[a]^=106;this.oHash.update(f),f.fill(0)}update(r){return t.default.exists(this),this.iHash.update(r),this}digestInto(r){t.default.exists(this),t.default.bytes(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:c,iHash:h,finished:u,destroyed:f,blockLen:a,outputLen:l}=this;return r=r,r.finished=u,r.destroyed=f,r.blockLen=a,r.outputLen=l,r.oHash=c._cloneInto(r.oHash),r.iHash=h._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const o=(i,r,c)=>new n(i,r).update(c).digest();e.hmac=o,e.hmac.create=(i,r)=>new n(i,r)})(he);Object.defineProperty(nt,"__esModule",{value:!0});nt.pbkdf2Async=nt.pbkdf2=void 0;const Et=C,qe=he,lt=M;function le(e,t,s,n){Et.default.hash(e);const o=(0,lt.checkOpts)({dkLen:32,asyncTick:10},n),{c:i,dkLen:r,asyncTick:c}=o;if(Et.default.number(i),Et.default.number(r),Et.default.number(c),i<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const h=(0,lt.toBytes)(t),u=(0,lt.toBytes)(s),f=new Uint8Array(r),a=qe.hmac.create(e,h),l=a._cloneInto().update(u);return{c:i,dkLen:r,asyncTick:c,DK:f,PRF:a,PRFSalt:l}}function fe(e,t,s,n,o){return e.destroy(),t.destroy(),n&&n.destroy(),o.fill(0),s}function ze(e,t,s,n){const{c:o,dkLen:i,DK:r,PRF:c,PRFSalt:h}=le(e,t,s,n);let u;const f=new Uint8Array(4),a=(0,lt.createView)(f),l=new Uint8Array(c.outputLen);for(let b=1,p=0;p<i;b++,p+=c.outputLen){const x=r.subarray(p,p+c.outputLen);a.setInt32(0,b,!1),(u=h._cloneInto(u)).update(f).digestInto(l),x.set(l.subarray(0,x.length));for(let B=1;B<o;B++){c._cloneInto(u).update(l).digestInto(l);for(let L=0;L<x.length;L++)x[L]^=l[L]}}return fe(c,h,r,u,l)}nt.pbkdf2=ze;async function Xe(e,t,s,n){const{c:o,dkLen:i,asyncTick:r,DK:c,PRF:h,PRFSalt:u}=le(e,t,s,n);let f;const a=new Uint8Array(4),l=(0,lt.createView)(a),b=new Uint8Array(h.outputLen);for(let p=1,x=0;x<i;p++,x+=h.outputLen){const B=c.subarray(x,x+h.outputLen);l.setInt32(0,p,!1),(f=u._cloneInto(f)).update(a).digestInto(b),B.set(b.subarray(0,B.length)),await(0,lt.asyncLoop)(o-1,r,L=>{h._cloneInto(f).update(b).digestInto(b);for(let T=0;T<B.length;T++)B[T]^=b[T]})}return fe(h,u,c,f,b)}nt.pbkdf2Async=Xe;var rt={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.SHA2=void 0;const Mt=C,yt=M;function Je(e,t,s,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,s,n);const o=BigInt(32),i=BigInt(4294967295),r=Number(s>>o&i),c=Number(s&i),h=n?4:0,u=n?0:4;e.setUint32(t+h,r,n),e.setUint32(t+u,c,n)}class Qe extends yt.Hash{constructor(t,s,n,o){super(),this.blockLen=t,this.outputLen=s,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,yt.createView)(this.buffer)}update(t){Mt.default.exists(this);const{view:s,buffer:n,blockLen:o}=this;t=(0,yt.toBytes)(t);const i=t.length;for(let r=0;r<i;){const c=Math.min(o-this.pos,i-r);if(c===o){const h=(0,yt.createView)(t);for(;o<=i-r;r+=o)this.process(h,r);continue}n.set(t.subarray(r,r+c),this.pos),this.pos+=c,r+=c,this.pos===o&&(this.process(s,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Mt.default.exists(this),Mt.default.output(t,this),this.finished=!0;const{buffer:s,view:n,blockLen:o,isLE:i}=this;let{pos:r}=this;s[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>o-r&&(this.process(n,0),r=0);for(let a=r;a<o;a++)s[a]=0;Je(n,o-8,BigInt(this.length*8),i),this.process(n,0);const c=(0,yt.createView)(t),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=h/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let a=0;a<u;a++)c.setUint32(4*a,f[a],i)}digest(){const{buffer:t,outputLen:s}=this;this.digestInto(t);const n=t.slice(0,s);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:s,buffer:n,length:o,finished:i,destroyed:r,pos:c}=this;return t.length=o,t.pos=c,t.finished=i,t.destroyed=r,o%s&&t.buffer.set(n),t}}Lt.SHA2=Qe;Object.defineProperty(rt,"__esModule",{value:!0});rt.sha224=rt.sha256=void 0;const Ye=Lt,F=M,Ze=(e,t,s)=>e&t^~e&s,ts=(e,t,s)=>e&t^e&s^t&s,es=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),q=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),z=new Uint32Array(64);class ue extends Ye.SHA2{constructor(){super(64,32,8,!1),this.A=q[0]|0,this.B=q[1]|0,this.C=q[2]|0,this.D=q[3]|0,this.E=q[4]|0,this.F=q[5]|0,this.G=q[6]|0,this.H=q[7]|0}get(){const{A:t,B:s,C:n,D:o,E:i,F:r,G:c,H:h}=this;return[t,s,n,o,i,r,c,h]}set(t,s,n,o,i,r,c,h){this.A=t|0,this.B=s|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=r|0,this.G=c|0,this.H=h|0}process(t,s){for(let a=0;a<16;a++,s+=4)z[a]=t.getUint32(s,!1);for(let a=16;a<64;a++){const l=z[a-15],b=z[a-2],p=(0,F.rotr)(l,7)^(0,F.rotr)(l,18)^l>>>3,x=(0,F.rotr)(b,17)^(0,F.rotr)(b,19)^b>>>10;z[a]=x+z[a-7]+p+z[a-16]|0}let{A:n,B:o,C:i,D:r,E:c,F:h,G:u,H:f}=this;for(let a=0;a<64;a++){const l=(0,F.rotr)(c,6)^(0,F.rotr)(c,11)^(0,F.rotr)(c,25),b=f+l+Ze(c,h,u)+es[a]+z[a]|0,x=((0,F.rotr)(n,2)^(0,F.rotr)(n,13)^(0,F.rotr)(n,22))+ts(n,o,i)|0;f=u,u=h,h=c,c=r+b|0,r=i,i=o,o=n,n=b+x|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,r=r+this.D|0,c=c+this.E|0,h=h+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(n,o,i,r,c,h,u,f)}roundClean(){z.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class ss extends ue{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}rt.sha256=(0,F.wrapConstructor)(()=>new ue);rt.sha224=(0,F.wrapConstructor)(()=>new ss);var G={};Object.defineProperty(G,"__esModule",{value:!0});G.sha384=G.sha512_256=G.sha512_224=G.sha512=G.SHA512=void 0;const ns=Lt,A=Ct,Dt=M,[rs,os]=A.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),X=new Uint32Array(80),J=new Uint32Array(80);class mt extends ns.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:s,Bh:n,Bl:o,Ch:i,Cl:r,Dh:c,Dl:h,Eh:u,El:f,Fh:a,Fl:l,Gh:b,Gl:p,Hh:x,Hl:B}=this;return[t,s,n,o,i,r,c,h,u,f,a,l,b,p,x,B]}set(t,s,n,o,i,r,c,h,u,f,a,l,b,p,x,B){this.Ah=t|0,this.Al=s|0,this.Bh=n|0,this.Bl=o|0,this.Ch=i|0,this.Cl=r|0,this.Dh=c|0,this.Dl=h|0,this.Eh=u|0,this.El=f|0,this.Fh=a|0,this.Fl=l|0,this.Gh=b|0,this.Gl=p|0,this.Hh=x|0,this.Hl=B|0}process(t,s){for(let v=0;v<16;v++,s+=4)X[v]=t.getUint32(s),J[v]=t.getUint32(s+=4);for(let v=16;v<80;v++){const d=X[v-15]|0,k=J[v-15]|0,H=A.default.rotrSH(d,k,1)^A.default.rotrSH(d,k,8)^A.default.shrSH(d,k,7),m=A.default.rotrSL(d,k,1)^A.default.rotrSL(d,k,8)^A.default.shrSL(d,k,7),S=X[v-2]|0,O=J[v-2]|0,w=A.default.rotrSH(S,O,19)^A.default.rotrBH(S,O,61)^A.default.shrSH(S,O,6),g=A.default.rotrSL(S,O,19)^A.default.rotrBL(S,O,61)^A.default.shrSL(S,O,6),_=A.default.add4L(m,g,J[v-7],J[v-16]),j=A.default.add4H(_,H,w,X[v-7],X[v-16]);X[v]=j|0,J[v]=_|0}let{Ah:n,Al:o,Bh:i,Bl:r,Ch:c,Cl:h,Dh:u,Dl:f,Eh:a,El:l,Fh:b,Fl:p,Gh:x,Gl:B,Hh:L,Hl:T}=this;for(let v=0;v<80;v++){const d=A.default.rotrSH(a,l,14)^A.default.rotrSH(a,l,18)^A.default.rotrBH(a,l,41),k=A.default.rotrSL(a,l,14)^A.default.rotrSL(a,l,18)^A.default.rotrBL(a,l,41),H=a&b^~a&x,m=l&p^~l&B,S=A.default.add5L(T,k,m,os[v],J[v]),O=A.default.add5H(S,L,d,H,rs[v],X[v]),w=S|0,g=A.default.rotrSH(n,o,28)^A.default.rotrBH(n,o,34)^A.default.rotrBH(n,o,39),_=A.default.rotrSL(n,o,28)^A.default.rotrBL(n,o,34)^A.default.rotrBL(n,o,39),j=n&i^n&c^i&c,U=o&r^o&h^r&h;L=x|0,T=B|0,x=b|0,B=p|0,b=a|0,p=l|0,{h:a,l}=A.default.add(u|0,f|0,O|0,w|0),u=c|0,f=h|0,c=i|0,h=r|0,i=n|0,r=o|0;const D=A.default.add3L(w,_,U);n=A.default.add3H(D,O,g,j),o=D|0}({h:n,l:o}=A.default.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:i,l:r}=A.default.add(this.Bh|0,this.Bl|0,i|0,r|0),{h:c,l:h}=A.default.add(this.Ch|0,this.Cl|0,c|0,h|0),{h:u,l:f}=A.default.add(this.Dh|0,this.Dl|0,u|0,f|0),{h:a,l}=A.default.add(this.Eh|0,this.El|0,a|0,l|0),{h:b,l:p}=A.default.add(this.Fh|0,this.Fl|0,b|0,p|0),{h:x,l:B}=A.default.add(this.Gh|0,this.Gl|0,x|0,B|0),{h:L,l:T}=A.default.add(this.Hh|0,this.Hl|0,L|0,T|0),this.set(n,o,i,r,c,h,u,f,a,l,b,p,x,B,L,T)}roundClean(){X.fill(0),J.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}G.SHA512=mt;class cs extends mt{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class is extends mt{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class as extends mt{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}G.sha512=(0,Dt.wrapConstructor)(()=>new mt);G.sha512_224=(0,Dt.wrapConstructor)(()=>new cs);G.sha512_256=(0,Dt.wrapConstructor)(()=>new is);G.sha384=(0,Dt.wrapConstructor)(()=>new as);Object.defineProperty(kt,"__esModule",{value:!0});var hs=kt.pbkdf2Sync=kt.pbkdf2=void 0;const de=nt,be=rt,ye=G,Ut=Ht;async function ls(e,t,s,n,o){if(!["sha256","sha512"].includes(o))throw new Error("Only sha256 and sha512 are supported");return(0,Ut.assertBytes)(e),(0,Ut.assertBytes)(t),(0,de.pbkdf2Async)(o==="sha256"?be.sha256:ye.sha512,e,t,{c:s,dkLen:n})}kt.pbkdf2=ls;function fs(e,t,s,n,o){if(!["sha256","sha512"].includes(o))throw new Error("Only sha256 and sha512 are supported");return(0,Ut.assertBytes)(e),(0,Ut.assertBytes)(t),(0,de.pbkdf2)(o==="sha256"?be.sha256:ye.sha512,e,t,{c:s,dkLen:n})}hs=kt.pbkdf2Sync=fs;var Bt={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});dt.scryptAsync=dt.scrypt=void 0;const it=C,xe=rt,pe=nt,ht=M,E=(e,t)=>e<<t|e>>>32-t;function Jt(e,t,s,n,o,i){let r=e[t++]^s[n++],c=e[t++]^s[n++],h=e[t++]^s[n++],u=e[t++]^s[n++],f=e[t++]^s[n++],a=e[t++]^s[n++],l=e[t++]^s[n++],b=e[t++]^s[n++],p=e[t++]^s[n++],x=e[t++]^s[n++],B=e[t++]^s[n++],L=e[t++]^s[n++],T=e[t++]^s[n++],v=e[t++]^s[n++],d=e[t++]^s[n++],k=e[t++]^s[n++],H=r,m=c,S=h,O=u,w=f,g=a,_=l,j=b,U=p,D=x,V=B,Y=L,Z=T,tt=v,et=d,st=k;for(let Kt=0;Kt<8;Kt+=2)w^=E(H+Z|0,7),U^=E(w+H|0,9),Z^=E(U+w|0,13),H^=E(Z+U|0,18),D^=E(g+m|0,7),tt^=E(D+g|0,9),m^=E(tt+D|0,13),g^=E(m+tt|0,18),et^=E(V+_|0,7),S^=E(et+V|0,9),_^=E(S+et|0,13),V^=E(_+S|0,18),O^=E(st+Y|0,7),j^=E(O+st|0,9),Y^=E(j+O|0,13),st^=E(Y+j|0,18),m^=E(H+O|0,7),S^=E(m+H|0,9),O^=E(S+m|0,13),H^=E(O+S|0,18),_^=E(g+w|0,7),j^=E(_+g|0,9),w^=E(j+_|0,13),g^=E(w+j|0,18),Y^=E(V+D|0,7),U^=E(Y+V|0,9),D^=E(U+Y|0,13),V^=E(D+U|0,18),Z^=E(st+et|0,7),tt^=E(Z+st|0,9),et^=E(tt+Z|0,13),st^=E(et+tt|0,18);o[i++]=r+H|0,o[i++]=c+m|0,o[i++]=h+S|0,o[i++]=u+O|0,o[i++]=f+w|0,o[i++]=a+g|0,o[i++]=l+_|0,o[i++]=b+j|0,o[i++]=p+U|0,o[i++]=x+D|0,o[i++]=B+V|0,o[i++]=L+Y|0,o[i++]=T+Z|0,o[i++]=v+tt|0,o[i++]=d+et|0,o[i++]=k+st|0}function ft(e,t,s,n,o){let i=n+0,r=n+16*o;for(let c=0;c<16;c++)s[r+c]=e[t+(2*o-1)*16+c];for(let c=0;c<o;c++,i+=16,t+=16)Jt(s,r,e,t,s,i),c>0&&(r+=16),Jt(s,i,e,t+=16,s,r)}function we(e,t,s){const n=(0,ht.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},s),{N:o,r:i,p:r,dkLen:c,asyncTick:h,maxmem:u,onProgress:f}=n;if(it.default.number(o),it.default.number(i),it.default.number(r),it.default.number(c),it.default.number(h),it.default.number(u),f!==void 0&&typeof f!="function")throw new Error("progressCb should be function");const a=128*i,l=a/4;if(o<=1||o&o-1||o>=2**(a/8)||o>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(r<0||r>(2**32-1)*32/a)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(c<0||c>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const b=a*(o+r);if(b>u)throw new Error(`Scrypt: parameters too large, ${b} (128 * r * (N + p)) > ${u} (maxmem)`);const p=(0,pe.pbkdf2)(xe.sha256,e,t,{c:1,dkLen:a*r}),x=(0,ht.u32)(p),B=(0,ht.u32)(new Uint8Array(a*o)),L=(0,ht.u32)(new Uint8Array(a));let T=()=>{};if(f){const v=2*o*r,d=Math.max(Math.floor(v/1e4),1);let k=0;T=()=>{k++,f&&(!(k%d)||k===v)&&f(k/v)}}return{N:o,r:i,p:r,dkLen:c,blockSize32:l,V:B,B32:x,B:p,tmp:L,blockMixCb:T,asyncTick:h}}function _e(e,t,s,n,o){const i=(0,pe.pbkdf2)(xe.sha256,e,s,{c:1,dkLen:t});return s.fill(0),n.fill(0),o.fill(0),i}function us(e,t,s){const{N:n,r:o,p:i,dkLen:r,blockSize32:c,V:h,B32:u,B:f,tmp:a,blockMixCb:l}=we(e,t,s);for(let b=0;b<i;b++){const p=c*b;for(let x=0;x<c;x++)h[x]=u[p+x];for(let x=0,B=0;x<n-1;x++)ft(h,B,h,B+=c,o),l();ft(h,(n-1)*c,u,p,o),l();for(let x=0;x<n;x++){const B=u[p+c-16]%n;for(let L=0;L<c;L++)a[L]=u[p+L]^h[B*c+L];ft(a,0,u,p,o),l()}}return _e(e,r,f,h,a)}dt.scrypt=us;async function ds(e,t,s){const{N:n,r:o,p:i,dkLen:r,blockSize32:c,V:h,B32:u,B:f,tmp:a,blockMixCb:l,asyncTick:b}=we(e,t,s);for(let p=0;p<i;p++){const x=c*p;for(let L=0;L<c;L++)h[L]=u[x+L];let B=0;await(0,ht.asyncLoop)(n-1,b,L=>{ft(h,B,h,B+=c,o),l()}),ft(h,(n-1)*c,u,x,o),l(),await(0,ht.asyncLoop)(n,b,L=>{const T=u[x+c-16]%n;for(let v=0;v<c;v++)a[v]=u[x+v]^h[T*c+v];ft(a,0,u,x,o),l()})}return _e(e,r,f,h,a)}dt.scryptAsync=ds;Object.defineProperty(Bt,"__esModule",{value:!0});var bs=Bt.scryptSync=Bt.scrypt=void 0;const ge=dt,Tt=Ht;async function ys(e,t,s,n,o,i,r){return(0,Tt.assertBytes)(e),(0,Tt.assertBytes)(t),(0,ge.scryptAsync)(e,t,{N:s,r:o,p:n,dkLen:i,onProgress:r})}Bt.scrypt=ys;function xs(e,t,s,n,o,i,r){return(0,Tt.assertBytes)(e),(0,Tt.assertBytes)(t),(0,ge.scrypt)(e,t,{N:s,r:o,p:n,dkLen:i,onProgress:r})}bs=Bt.scryptSync=xs;var Vt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.secp256k1=void 0;var t=Be;Object.defineProperty(e,"secp256k1",{enumerable:!0,get:function(){return t.secp256k1}})})(Vt);const ps=ke(Vt),gs=ve({__proto__:null,default:ps},[Vt]);export{bs as a,Ke as b,Ce as c,Re as d,gs as e,Fe as g,Ie as k,hs as p,Vt as s,Ht as u};
