import{k as X,u as b,g as Ut}from"./ethereum-cryptography-7a8fc714.js";import"./is-my-json-valid-2c93b9e3.js";import{v as p,l as zt,m as Vt,a as L,i as m,n as Ft,b as g,o as Y,p as Gt,u as yt,q as Jt,r as Xt,s as Yt,w as Zt,x as Kt,y as te,z as ee,d as ot,A as ct,B as A,C as ne}from"./web3-validator-6b520267.js";import{ae as B,aa as wt,af as ie,ag as It,ah as vt,ai as se,aj as At,ak as F,al as re,am as oe,an as at,ao as ut,ap as ce,r as ae,O as ue,c as he,ab as ht,aq as fe,ar as de,as as le,at as me,au as pe,ad as ft}from"./web3-errors-484f11ce.js";import{B as S,T as bt,a as C,F as dt,W as ge}from"./web3-types-ce0eb23a.js";import{e as _e}from"./events-f5832a60.js";const ye=BigInt(10),f=t=>ye**BigInt(t),Z={noether:BigInt("0"),wei:BigInt(1),kwei:f(3),Kwei:f(3),babbage:f(3),femtoether:f(3),mwei:f(6),Mwei:f(6),lovelace:f(6),picoether:f(6),gwei:f(9),Gwei:f(9),shannon:f(9),nanoether:f(9),nano:f(9),szabo:f(12),microether:f(12),micro:f(12),finney:f(15),milliether:f(15),milli:f(15),ether:f(18),kether:f(21),grand:f(21),mether:f(24),gether:f(27),tether:f(30)},I=t=>{if(p.validate(["bytes"],[t]),t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return zt(t);throw new B(t)},{uint8ArrayToHexString:we}=yt,w=t=>we(I(t)),Q=t=>typeof t=="string"&&t.slice(0,2).toLowerCase()!=="0x"?I(`0x${t}`):I(t),P=t=>(p.validate(["hex"],[t]),Vt(t)),Ie=P,y=(t,e)=>{p.validate(["int"],[t]);let n=Ft(t);return e&&(!n.startsWith("-")&&n.length%2===1?n="0x0".concat(n.slice(2)):n.length%2===0&&n.startsWith("-")&&(n="-0x0".concat(n.slice(3)))),n},ve=y,Ae=t=>P(t).toString(),E=t=>{p.validate(["string"],[t]);let e=t.replace(/^(?:\u0000)/,"");return e=e.replace(/(?:\u0000)$/,""),w(new TextEncoder().encode(e))},be=E,Ee=E,K=t=>b.bytesToUtf8(Q(t)),Se=t=>typeof t=="string"?K(t):(p.validate(["bytes"],[t]),b.bytesToUtf8(t)),Te=K,Et=t=>{p.validate(["string"],[t]);let e="";for(let n=0;n<t.length;n+=1){const i=t.charCodeAt(n).toString(16);e+=i.length%2!==0?`0${i}`:i}return`0x${e}`},xe=Et,St=t=>new TextDecoder("ascii").decode(Q(t)),Re=St,j=(t,e)=>{if(typeof t=="string"&&L(t))return e?"address":`0x${t.toLowerCase().replace(/^0x/i,"")}`;if(typeof t=="boolean")return e?"bool":t?"0x01":"0x00";if(typeof t=="number")return e?t<0?"int256":"uint256":y(t);if(typeof t=="bigint")return e?"bigint":y(t);if(typeof t=="object"&&t)return e?"string":E(JSON.stringify(t));if(typeof t=="string"){if(t.startsWith("-0x")||t.startsWith("-0X"))return e?"int256":y(t);if(g(t))return e?"bytes":t;if(Y(t)&&!Gt(t))return e?"bytes":`0x${t}`;if(!Number.isFinite(t))return e?"string":E(t)}throw new ie(t)},_=t=>{if(typeof t=="number")return t;if(typeof t=="bigint")return t>=Number.MIN_SAFE_INTEGER&&t<=Number.MAX_SAFE_INTEGER?Number(t):t;if(typeof t=="string"&&g(t))return P(t);try{return _(BigInt(t))}catch{throw new It(t)}},v=t=>{if(typeof t=="number")return BigInt(t);if(typeof t=="bigint")return t;if(typeof t=="string"&&Y(t))return BigInt(t);throw new It(t)},Ce=(t,e)=>{const n=Z[e];if(!n)throw new vt(e);const i=String(_(t)),s=n.toString().length-1;if(s<=0)return i.toString();const r=i.padStart(s,"0"),o=r.slice(0,-s),h=r.slice(-s).replace(/\.?0+$/,"");return o===""?`0.${h}`:h===""?o:`${o}.${h}`},Be=(t,e)=>{p.validate(["number"],[t]);const n=Z[e];if(!n)throw new vt(e);const[i,s]=String(typeof t=="string"&&!g(t)?t:_(t)).split(".").concat(""),o=BigInt(`${i}${s}`)*n,h=n.toString().length-1,d=Math.min(s.length,h);return d===0?o.toString():o.toString().padStart(d,"0").slice(0,-d)},ke=t=>{if(!L(t,!1))throw new wt(t);const e=t.toLowerCase().replace(/^0x/i,""),n=w(X(b.utf8ToBytes(e)));if(m(n)||n==="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470")return"";let i="0x";const s=n.replace(/^0x/i,"");for(let r=0;r<e.length;r+=1)parseInt(s[r],16)>7?i+=e[r].toUpperCase():i+=e[r];return i},je=g,$e=Y,Ne=Jt,qe=L,Oe=Xt,Le=Yt,Qe=Zt,Pe=Kt,We=te,De=ee,Me=(t,e)=>{const n=typeof t=="string"&&ot(t),i=typeof e=="string"&&ot(e);if(t===e||(t==="earliest"||t===0)&&(e==="earliest"||e===0))return 0;if(t==="earliest"&&e>0)return-1;if(e==="earliest"&&t>0)return 1;if(n&&i){const o={[S.EARLIEST]:1,[S.FINALIZED]:2,[S.SAFE]:3,[S.LATEST]:4,[S.PENDING]:5};return o[t]<o[e]?-1:1}if(n&&!i||!n&&i)throw new se("Cannot compare blocktag with provided non-blocktag input.");const s=BigInt(t),r=BigInt(e);return s<r?-1:s===r?0:1},Tt=m,lt=t=>typeof t=="object"&&!m(t)&&!Array.isArray(t)&&!(t instanceof bt),tt=(t,...e)=>{const n=t;if(!lt(n))return n;for(const i of e)for(const s in i)lt(i[s])?(n[s]||(n[s]={}),tt(n[s],i[s])):!m(i[s])&&Object.hasOwnProperty.call(i,s)&&(Array.isArray(i[s])||i[s]instanceof bt?n[s]=i[s].slice(0):n[s]=i[s]);return n},x=(t,e,n="0")=>typeof t=="string"?g(t)?ct(t,e,n):t.padStart(e,n):(p.validate(["int"],[t]),ct(t,e,n)),xt=(t,e,n="0")=>{if(typeof t=="string"&&!g(t))return t.padEnd(e,n);p.validate(["int"],[t]);const i=typeof t=="string"&&g(t)?t:y(t),s=i.startsWith("-")?3:2;return i.padEnd(e+s,n)},Rt=xt,G=x,Ct=(t,e=64)=>{p.validate(["int"],[t]);const n=_(t);if(n>=0)return x(j(n),e);const i=BigInt(2)**BigInt(e*4);if(-n>=i)throw new At(`value: ${t}, nibbleWidth: ${e}`);const r=BigInt(n)+i;return x(y(r),e)},He=(t,e=64)=>{p.validate(["int"],[t]);const n=_(t);if(n<0)return n;const i=Math.ceil(Math.log(Number(n))/Math.log(2));if(i>e*4)throw new At(`value: "${t}", nibbleWidth: "${e}"`);if(e*4!==i)return n;const s=BigInt(2)**(BigInt(e)*BigInt(4));return _(BigInt(n)-s)};function Bt(...t){const e=t.reduce((s,r)=>s+r.length,0),n=new Uint8Array(e);let i=0;for(const s of t)n.set(s,i),i+=s.length;return n}function Ue(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.byteLength;n+=1)if(t[n]!==e[n])return!1;return!0}const{parseBaseType:ze}=yt,Ve=t=>typeof t=="object"&&!m(t)&&"number"in t&&"bytes"in t,Fe=(t,e,n=[])=>{let i=Object.assign({},t),s;for(const r of e){if(i.oneOf&&s){const o=n.find(function(h){return this===h[0]},s??"");o&&o[0]===s&&(i=i.oneOf[o[1]])}if(!i.properties&&!i.items)return;if(i.properties)i=i.properties[r];else if(i.items&&i.items.properties){const o=i.items.properties;if(!o)return;i=o[r]}else i.items&&A(i.items)?i=i.items:i.items&&Array.isArray(i.items)&&(i=i.items[parseInt(r,10)]);i&&r&&(s=r)}return i},T=(t,e,n)=>{try{const{baseType:i,baseTypeSize:s}=ze(e);if(i==="int"||i==="uint")switch(n.number){case C.NUMBER:return Number(v(t));case C.HEX:return y(v(t));case C.STR:return v(t).toString();case C.BIGINT:return v(t);default:throw new F(`Invalid format: ${String(n.number)}`)}if(i==="bytes"){let r;switch(s?typeof t=="string"?r=x(t,s*2):t instanceof Uint8Array&&(r=Bt(new Uint8Array(s-t.length),t)):r=t,n.bytes){case dt.HEX:return w(I(r));case dt.UINT8ARRAY:return I(r);default:throw new F(`Invalid format: ${String(n.bytes)}`)}}}catch{return t}return t},$=(t,e,n,i,s=[])=>{var r,o;if(!A(t)&&!Array.isArray(t))return T(t,e==null?void 0:e.format,i);const h=t;for(const[d,u]of Object.entries(h)){n.push(d);const c=Fe(e,n,s);if(m(c)){delete h[d],n.pop();continue}if(A(u)){$(u,e,n,i),n.pop();continue}if(Array.isArray(u)){let a=c;if((c==null?void 0:c.oneOf)!==void 0&&c.oneOf.forEach((l,Ht)=>{var H,U;!Array.isArray(c==null?void 0:c.items)&&(typeof u[0]=="object"&&((H=l==null?void 0:l.items)===null||H===void 0?void 0:H.type)==="object"||typeof u[0]=="string"&&((U=l==null?void 0:l.items)===null||U===void 0?void 0:U.type)!=="object")&&(a=l,s.push([d,Ht]))}),m(a==null?void 0:a.items)){delete h[d],n.pop();continue}if(A(a.items)&&!m(a.items.format)){for(let l=0;l<u.length;l+=1)h[d][l]=T(u[l],(r=a==null?void 0:a.items)===null||r===void 0?void 0:r.format,i);n.pop();continue}if(!Array.isArray(a==null?void 0:a.items)&&((o=a==null?void 0:a.items)===null||o===void 0?void 0:o.type)==="object"){for(const l of u)$(l,e,n,i,s);n.pop();continue}if(Array.isArray(a==null?void 0:a.items)){for(let l=0;l<u.length;l+=1)h[d][l]=T(u[l],a.items[l].format,i);n.pop();continue}}h[d]=T(u,c.format,i),n.pop()}return h},Ge=(t,e,n)=>{let i;A(e)?i=tt({},e):Array.isArray(e)?i=[...e]:i=e;const s=A(t)?t:ne(t);if(!s.properties&&!s.items&&!s.format)throw new F("Invalid json schema for formatting");return $(i,s,[],n)},kt="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",W=t=>{let e;typeof t=="string"?t.startsWith("0x")&&g(t)?e=Q(t):e=b.utf8ToBytes(t):e=t;const n=w(X(e));return n===kt?void 0:n},jt=t=>{const e=W(t);return m(e)?kt:e},mt=t=>{let e;return typeof t=="bigint"||typeof t=="number"?e=b.utf8ToBytes(t.toString()):Array.isArray(t)?e=new Uint8Array(t):typeof t=="string"&&!g(t)?e=b.utf8ToBytes(t):e=I(t),w(X(e))},Je=t=>{if(Array.isArray(t))throw new Error("Autodetection of array types is not supported.");let e,n;return typeof t=="object"&&("t"in t||"type"in t)&&("v"in t||"value"in t)?(e="t"in t?t.t:t.type,n="v"in t?t.v:t.value):(e=j(t,!0),n=j(t),!e.startsWith("int")&&!e.startsWith("uint")&&(e="bytes")),(e.startsWith("int")||e.startsWith("uint"))&&typeof n=="string"&&!/^(-)?0x/i.test(n)&&(n=v(n)),[e,n]},Xe=t=>t.startsWith("int[")?`int256${t.slice(3)}`:t==="int"?"int256":t.startsWith("uint[")?`uint256'${t.slice(4)}`:t==="uint"?"uint256":t,z=(t,e)=>{const n=/^(\d+).*$/.exec(t.slice(e));return n?parseInt(n[1],10):0},pt=t=>t.toString(2).length,gt=(t,e)=>{const n=e.toString();if(t==="string"){if(typeof e=="string")return E(e);throw new re(e)}if(t==="bool"||t==="boolean"){if(typeof e=="boolean")return e?"01":"00";throw new oe(e)}if(t==="address"){if(!L(n))throw new wt(n);return n}const i=Xe(t);if(t.startsWith("uint")){const s=z(i,4);if(s%8||s<8||s>256)throw new at(n);const r=_(n);if(pt(r)>s)throw new ut(n);if(r<BigInt(0))throw new ce(n);return s?G(r.toString(16),s/8*2):r.toString(16)}if(t.startsWith("int")){const s=z(i,3);if(s%8||s<8||s>256)throw new at(t);const r=_(n);if(pt(r)>s)throw new ut(n);return r<BigInt(0)?Ct(r.toString(),s/8*2):s?G(r.toString(16),s/4):r.toString(16)}if(i==="bytes"){if(n.replace(/^0x/i,"").length%2!==0)throw new B(n);return n}if(t.startsWith("bytes")){if(n.replace(/^0x/i,"").length%2!==0)throw new B(n);const s=z(t,5);if(!s||s<1||s>64||s<n.replace(/^0x/i,"").length/2)throw new B(n);return Rt(n,s*2)}return""},$t=t=>{const[e,n]=Je(t);return Array.isArray(n)?n.map(r=>gt(e,r).replace("0x","")).join(""):gt(e,n).replace("0x","")},et=(...t)=>`0x${Array.prototype.slice.call(t).map($t).join("").toLowerCase()}`,Ye=(...t)=>W(et(...t)),Ze=(...t)=>jt(et(...t)),Ke=t=>W(`0x${(typeof t=="number"?t.toString():t).padStart(64,"0")}`),nt=t=>Ut(t),tn=t=>w(nt(t));var N=globalThis&&globalThis.__awaiter||function(t,e,n,i){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function h(c){try{u(i.next(c))}catch(a){o(a)}}function d(c){try{u(i.throw(c))}catch(a){o(a)}}function u(c){c.done?r(c.value):s(c.value).then(h,d)}u((i=i.apply(t,e||[])).next())})};function en(t){return(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function J(t,e,n){return N(this,void 0,void 0,function*(){let i;const s=yield Promise.race([t instanceof Promise?t:t(),new Promise((r,o)=>{i=setTimeout(()=>n?o(n):r(void 0),e)})]);if(i&&clearTimeout(i),s instanceof Error)throw s;return s})}function nn(t,e){return N(this,void 0,void 0,function*(){const n=J(t,e);let i;const s=new Promise((o,h)=>{i=setInterval(()=>{N(this,void 0,void 0,function*(){try{const d=yield J(t,e);m(d)||(clearInterval(i),o(d))}catch(d){clearInterval(i),h(d)}})},e)}),r=yield n;return m(r)?s:(i&&clearInterval(i),r)})}function sn(t,e){let n;const i=new Promise((s,r)=>{n=setTimeout(()=>{r(e)},t)});return[n,i]}function rn(t,e){let n;const i=new Promise((s,r)=>{n=setInterval(()=>{N(this,void 0,void 0,function*(){const o=yield t();o&&(clearInterval(n),r(o))})},e)});return[n,i]}const Nt=()=>{const t=nt(16);t[6]=t[6]&15|64,t[8]=t[8]&63|128;const e=w(t);return[e.substring(2,10),e.substring(10,14),e.substring(14,18),e.substring(18,22),e.substring(22,34)].join("-")},qt=t=>{const e=t.error.code;return ae.has(e)||e>=-32099&&e<=-32e3},D=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&"result"in t&&m(t.error)&&(typeof t.id=="number"||typeof t.id=="string"),M=t=>!Array.isArray(t)&&t.jsonrpc==="2.0"&&!!t&&m(t.result)&&"error"in t&&(typeof t.id=="number"||typeof t.id=="string"),it=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&!m(t.params)&&!m(t.method),Ot=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&"id"in t&&"result"in t,q=t=>D(t)||M(t),st=t=>Array.isArray(t)?t.every(q):q(t),O=t=>Array.isArray(t)&&t.length>1&&st(t);let k;const Lt=t=>{k=t},R=t=>{var e,n,i,s;return typeof k<"u"&&(k+=1),{jsonrpc:(e=t.jsonrpc)!==null&&e!==void 0?e:"2.0",id:(i=(n=t.id)!==null&&n!==void 0?n:k)!==null&&i!==void 0?i:Nt(),method:t.method,params:(s=t.params)!==null&&s!==void 0?s:void 0}},Qt=t=>t.map(e=>R(e)),rt=t=>Array.isArray(t)&&t.length>1,on=Object.freeze(Object.defineProperty({__proto__:null,isBatchRequest:rt,isBatchResponse:O,isResponseRpcError:qt,isResponseWithError:M,isResponseWithNotification:it,isResponseWithResult:D,isSubscriptionResult:Ot,isValidResponse:st,setRequestIdStart:Lt,toBatchPayload:Qt,toPayload:R,validateResponse:q},Symbol.toStringTag,{value:"Module"}));var V=globalThis&&globalThis.__awaiter||function(t,e,n,i){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function h(c){try{u(i.next(c))}catch(a){o(a)}}function d(c){try{u(i.throw(c))}catch(a){o(a)}}function u(c){c.done?r(c.value):s(c.value).then(h,d)}u((i=i.apply(t,e||[])).next())})},Pt;class Wt{constructor({timeout:e,eagerStart:n,timeoutMessage:i}={timeout:0,eagerStart:!1,timeoutMessage:"DeferredPromise timed out"}){this[Pt]="Promise",this._state="pending",this._promise=new Promise((s,r)=>{this._resolve=s,this._reject=r}),this._timeoutMessage=i,this._timeoutInterval=e,n&&this.startTimer()}get state(){return this._state}then(e,n){return V(this,void 0,void 0,function*(){return this._promise.then(e,n)})}catch(e){return V(this,void 0,void 0,function*(){return this._promise.catch(e)})}finally(e){return V(this,void 0,void 0,function*(){return this._promise.finally(e)})}resolve(e){this._resolve(e),this._state="fulfilled",this._clearTimeout()}reject(e){this._reject(e),this._state="rejected",this._clearTimeout()}startTimer(){this._timeoutInterval&&this._timeoutInterval>0&&(this._timeoutId=setTimeout(this._checkTimeout.bind(this),this._timeoutInterval))}_checkTimeout(){this._state==="pending"&&this._timeoutId&&this.reject(new ue(this._timeoutMessage))}_clearTimeout(){this._timeoutId&&clearTimeout(this._timeoutId)}}Pt=Symbol.toStringTag;class Dt{constructor(e,n){this.eventEmitter=e,this.autoReconnect=n}clearQueues(){typeof this._clearQueues=="function"&&this._clearQueues()}onError(e){this._clearQueues=e}parseResponse(e){const n=[];return e.replace(/\}[\n\r]?\{/g,"}|--|{").replace(/\}\][\n\r]?\[\{/g,"}]|--|[{").replace(/\}[\n\r]?\[\{/g,"}|--|[{").replace(/\}\][\n\r]?\{/g,"}]|--|{").split("|--|").forEach(s=>{let r=s;this.lastChunk&&(r=this.lastChunk+r);let o;try{o=JSON.parse(r)}catch{this.lastChunk=r,this.lastChunkTimeout&&clearTimeout(this.lastChunkTimeout),this.lastChunkTimeout=setTimeout(()=>{this.autoReconnect||(this.clearQueues(),this.eventEmitter.emit("error",new he({id:1,jsonrpc:"2.0",error:{code:2,message:"Chunk timeout"}})))},1e3*15);return}clearTimeout(this.lastChunkTimeout),this.lastChunk=void 0,o&&n.push(o)}),n}}var _t=globalThis&&globalThis.__awaiter||function(t,e,n,i){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function h(c){try{u(i.next(c))}catch(a){o(a)}}function d(c){try{u(i.throw(c))}catch(a){o(a)}}function u(c){c.done?r(c.value):s(c.value).then(h,d)}u((i=i.apply(t,e||[])).next())})};class Mt extends ge{constructor(){super(...arguments),this._eventEmitter=new _e.EventEmitter,this._chainId="",this._accounts=[]}_getChainId(){var e;return _t(this,void 0,void 0,function*(){const n=yield this.request(R({method:"eth_chainId",params:[]}));return(e=n==null?void 0:n.result)!==null&&e!==void 0?e:""})}_getAccounts(){var e;return _t(this,void 0,void 0,function*(){const n=yield this.request(R({method:"eth_accounts",params:[]}));return(e=n==null?void 0:n.result)!==null&&e!==void 0?e:[]})}_onConnect(){Promise.all([this._getChainId().then(e=>{e!==this._chainId&&(this._chainId=e,this._eventEmitter.emit("chainChanged",this._chainId))}).catch(e=>{console.error(e)}),this._getAccounts().then(e=>{this._accounts.length===e.length&&e.every(n=>e.includes(n))||(this._accounts=e,this._onAccountsChanged())}).catch(e=>{console.error(e)})]).then(()=>this._eventEmitter.emit("connect",{chainId:this._chainId})).catch(e=>{console.error(e)})}_onDisconnect(e,n){this._eventEmitter.emit("disconnect",{code:e,data:n})}_onAccountsChanged(){this._eventEmitter.emit("accountsChanged",this._accounts)}}var cn=globalThis&&globalThis.__awaiter||function(t,e,n,i){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function h(c){try{u(i.next(c))}catch(a){o(a)}}function d(c){try{u(i.throw(c))}catch(a){o(a)}}function u(c){c.done?r(c.value):s(c.value).then(h,d)}u((i=i.apply(t,e||[])).next())})};const an={autoReconnect:!0,delay:5e3,maxAttempts:5},un=1e3;class hn extends Mt{constructor(e,n,i){if(super(),this._connectionStatus="connecting",this._onMessageHandler=this._onMessage.bind(this),this._onOpenHandler=this._onConnect.bind(this),this._onCloseHandler=this._onCloseEvent.bind(this),this._onErrorHandler=this._onError.bind(this),!this._validateProviderPath(e))throw new ht(e);this._socketPath=e,this._socketOptions=n,this._reconnectOptions=Object.assign(Object.assign({},an),i??{}),this._pendingRequestsQueue=new Map,this._sentRequestsQueue=new Map,this._init(),this.connect(),this.chunkResponseParser=new Dt(this._eventEmitter,this._reconnectOptions.autoReconnect),this.chunkResponseParser.onError(()=>{this._clearQueues()}),this.isReconnecting=!1}get SocketConnection(){return this._socketConnection}_init(){this._reconnectAttempts=0}connect(){try{this._openSocketConnection(),this._connectionStatus="connecting",this._addSocketListeners()}catch(e){if(this.isReconnecting)setImmediate(()=>{this._reconnect()});else throw this._connectionStatus="disconnected",e&&e.message?new fe(`Error while connecting to ${this._socketPath}. Reason: ${e.message}`):new ht(this._socketPath)}}_validateProviderPath(e){return!!e}supportsSubscriptions(){return!0}on(e,n){this._eventEmitter.on(e,n)}once(e,n){this._eventEmitter.once(e,n)}removeListener(e,n){this._eventEmitter.removeListener(e,n)}_onDisconnect(e,n){this._connectionStatus="disconnected",super._onDisconnect(e,n)}disconnect(e,n){const i=e??un;this._removeSocketListeners(),this.getStatus()!=="disconnected"&&this._closeSocketConnection(i,n),this._onDisconnect(i,n)}removeAllListeners(e){this._eventEmitter.removeAllListeners(e)}_onError(e){this.isReconnecting?this._reconnect():this._eventEmitter.emit("error",e)}reset(){this._sentRequestsQueue.clear(),this._pendingRequestsQueue.clear(),this._init(),this._removeSocketListeners(),this._addSocketListeners()}_reconnect(){this.isReconnecting||(this.isReconnecting=!0,this._sentRequestsQueue.size>0&&this._sentRequestsQueue.forEach((e,n)=>{e.deferredPromise.reject(new de),this._sentRequestsQueue.delete(n)}),this._reconnectAttempts<this._reconnectOptions.maxAttempts?(this._reconnectAttempts+=1,setTimeout(()=>{this._removeSocketListeners(),this.connect(),this.isReconnecting=!1},this._reconnectOptions.delay)):(this.isReconnecting=!1,this._clearQueues(),this._removeSocketListeners(),this._eventEmitter.emit("error",new le(this._reconnectOptions.maxAttempts))))}request(e){return cn(this,void 0,void 0,function*(){if(Tt(this._socketConnection))throw new Error("Connection is undefined");this.getStatus()==="disconnected"&&this.connect();const n=rt(e)?e[0].id:e.id;if(!n)throw new me("Request Id not defined");if(this._sentRequestsQueue.has(n))throw new pe(n);const i=new Wt;i.catch(r=>{this._eventEmitter.emit("error",r)});const s={payload:e,deferredPromise:i};if(this.getStatus()==="connecting")return this._pendingRequestsQueue.set(n,s),s.deferredPromise;this._sentRequestsQueue.set(n,s);try{this._sendToSocket(s.payload)}catch(r){this._sentRequestsQueue.delete(n),this._eventEmitter.emit("error",r)}return i})}_onConnect(){this._connectionStatus="connected",this._reconnectAttempts=0,super._onConnect(),this._sendPendingRequests()}_sendPendingRequests(){for(const[e,n]of this._pendingRequestsQueue.entries())this._sendToSocket(n.payload),this._pendingRequestsQueue.delete(e),this._sentRequestsQueue.set(e,n)}_onMessage(e){const n=this._parseResponses(e);if(n.length===0){this._reconnectOptions.autoReconnect&&this._reconnect();return}for(const i of n){if(it(i)&&i.method.endsWith("_subscription")){this._eventEmitter.emit("message",i);return}const s=O(i)?i[0].id:i.id,r=this._sentRequestsQueue.get(s);if(!r)return;(O(i)||D(i)||M(i))&&(this._eventEmitter.emit("message",i),r.deferredPromise.resolve(i)),this._sentRequestsQueue.delete(s)}}_clearQueues(e){this._pendingRequestsQueue.size>0&&this._pendingRequestsQueue.forEach((n,i)=>{n.deferredPromise.reject(new ft(e)),this._pendingRequestsQueue.delete(i)}),this._sentRequestsQueue.size>0&&this._sentRequestsQueue.forEach((n,i)=>{n.deferredPromise.reject(new ft(e)),this._sentRequestsQueue.delete(i)}),this._removeSocketListeners()}}const _n=Object.freeze(Object.defineProperty({__proto__:null,ChunkResponseParser:Dt,Eip1193Provider:Mt,SocketProvider:hn,Web3DeferredPromise:Wt,asciiToHex:Et,bytesToHex:w,bytesToUint8Array:I,checkAddressCheckSum:Ne,compareBlockNumbers:Me,convert:$,convertScalarValue:T,encodePacked:et,ethUnitMap:Z,format:Ge,fromAscii:xe,fromDecimal:ve,fromTwosComplement:He,fromUtf8:be,fromWei:Ce,getStorageSlotNumForLongString:Ke,hexToAscii:St,hexToBytes:Q,hexToNumber:P,hexToNumberString:Ae,hexToString:Te,hexToUtf8:K,isAddress:qe,isBatchRequest:rt,isBatchResponse:O,isBloom:Oe,isContractAddressInBloom:Pe,isDataFormat:Ve,isHex:$e,isHexStrict:je,isInBloom:Le,isNullish:Tt,isPromise:en,isResponseRpcError:qt,isResponseWithError:M,isResponseWithNotification:it,isResponseWithResult:D,isSubscriptionResult:Ot,isTopic:We,isTopicInBloom:De,isUserEthereumAddressInBloom:Qe,isValidResponse:st,jsonRpc:on,keccak256:mt,keccak256Wrapper:mt,leftPad:G,mergeDeep:tt,numberToHex:y,padLeft:x,padRight:xt,pollTillDefined:nn,processSolidityEncodePackedArgs:$t,randomBytes:nt,randomHex:tn,rejectIfConditionAtInterval:rn,rejectIfTimeout:sn,rightPad:Rt,setRequestIdStart:Lt,sha3:W,sha3Raw:jt,soliditySha3:Ye,soliditySha3Raw:Ze,stringToHex:Ee,toAscii:Re,toBatchPayload:Qt,toBigInt:v,toChecksumAddress:ke,toDecimal:Ie,toHex:j,toNumber:_,toPayload:R,toTwosComplement:Ct,toUtf8:Se,toWei:Be,uint8ArrayConcat:Bt,uint8ArrayEquals:Ue,utf8ToHex:E,uuidV4:Nt,validateResponse:q,waitWithTimeout:J},Symbol.toStringTag,{value:"Module"}));export{jt as A,Bt as B,Ue as C,E as D,be as E,nt as F,Nt as G,Ve as H,W as I,P as J,hn as S,Wt as W,D as a,rt as b,Qt as c,R as d,en as e,Ge as f,M as g,qt as h,Tt as i,O as j,it as k,w as l,tt as m,Q as n,mt as o,sn as p,nn as q,rn as r,y as s,j as t,_n as u,I as v,ke as w,_ as x,G as y,Rt as z};
